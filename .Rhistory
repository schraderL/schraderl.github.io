# create a list containing all JSON files
files <-list.files(path="/Users/lukas/sciebo/Projects/LGT/GAGA-0200/results/dnds/", pattern="json", full.names=TRUE)
files
# load necessary packages
#install.packages("rjson")
library("rjson")
# create a list containing all JSON files
files <-list.files(path="/Users/lukas/sciebo/Projects/LGT/GAGA-0200/results/dnds/", pattern="json", full.names=TRUE)
# create an empty list to append single data frames in the loop
datalist <- list()
# loop over JSON files to create a list containing all data frames from files + OG
for (i in files) {
# unpack JSON file and turn it into a data frame
result = fromJSON(file = i )
datalist[[i]] <- result
}
result
result[[1]]
fromJSON(file = i )
result
result$analysis
result$`branch attributes`
result$fits
result$`branch attributes`
View(result$`branch attributes`)
result$`branch attributes`[[2]]
result$`branch attributes`[[1]]
result$`branch attributes`[[1]]$B_C_nipp_WP_192380548_1
result$`branch attributes`[[1]][[2]]$`Baseline MG94xREV omega ratio`
result$`branch attributes`[[1]][[1]]$`Baseline MG94xREV omega ratio`
result$`branch attributes`[[1]][[2]]$`Baseline MG94xREV omega ratio`
result$`branch attributes`[[1]][[3]]$`Baseline MG94xREV omega ratio`
result$`branch attributes`
names(result$`branch attributes`)
result$`branch attributes`$attributes
result$`branch attributes`$attributes$`Baseline MG94xREV omega ratio`
result$`branch attributes`$attributes$`Baseline MG94xREV omega ratio`$`attribute type`
result$`branch attributes`$attributes
result$`branch attributes`$`0`[[1]]$`Baseline MG94xREV omega ratio`
datalist[[1]]$`branch attributes`$`0`[[1]]$`Baseline MG94xREV omega ratio`
datalist[[2]]$`branch attributes`$`0`[[1]]$`Baseline MG94xREV omega ratio`
names(datalist)
datalist[["/Users/lukas/sciebo/Projects/LGT/GAGA-0200/results/dnds//OG0000204.cds.aln.fa.ABSREL.json"]]$`branch attributes`$`0`[[1]]$`Baseline MG94xREV omega ratio`
datalist[[1]]$`branch attributes`$`0`
names(datalist[[1]]$`branch attributes`$`0`)
names(datalist[[1]]$`branch attributes`$`0`[[9]])
datalist[[1]]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`
datalist[[2]]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`
datalist[[2]]$`branch attributes`$`0`[[5]]$`Baseline MG94xREV omega ratio`
datalist[[1]]$`branch attributes`$`0`[[5]]$`Baseline MG94xREV omega ratio`
datalist[2]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`
datalist$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`
for (p in length(datalist)){datalist[[p]]$`branch attributes`$`0`[[5]]$`Baseline MG94xREV omega ratio`}
for (p in length(datalist)){GAGA0200[p]<-datalist[[p]]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`}
for (p in length(datalist)){omega.GAGA0200[p]<-datalist[[p]]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`}
omega.GAGA0200<-vector()
for (p in length(datalist)){GAGA0200[p]<-datalist[[p]]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`}
for (p in length(datalist)){omega.GAGA0200[p]<-datalist[[p]]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`}
omega.GAGA0200
p
for (p in 1:length(datalist)){omega.GAGA0200[p]<-datalist[[p]]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`}
omega.GAGA0200
omega.GAGA0200<-vector()
omega.B_chro<-vector()
for (p in 1:length(datalist)){omega.GAGA0200[p]<-datalist[[p]]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`}
for (p in 1:length(datalist)){omega.B_chro[p]<-datalist[[p]]$`branch attributes`$`0`[[2]]$`Baseline MG94xREV omega ratio`}
omega.B_chro
boxplot(omega.B_chro,omega.GAGA0200)
boxplot(omega.B_chro,omega.GAGA0200,outline=F)
datalist[[1]]$`branch attributes`$`0`[[9]]
datalist[[1]]$`branch attributes`$`0`[[9]]$`original name`
datalist[[2]]$`branch attributes`$`0`[[9]]$`original name`
datalist[[3]]$`branch attributes`$`0`[[9]]$`original name`
omega.GAGA0200<-vector()
omega.B_chro<-vector()
# loop over each element in datalist and extract the omega rate for each branch.
for (p in 1:length(datalist)){
omega.GAGA0200[p]<-datalist[[p]]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`
names(omega.B_chro)[p]<-datalist[[p]]$`branch attributes`$`0`[[2]]$`original name`
}
omega.GAGA0200<-vector()
omega.B_chro<-vector()
# loop over each element in datalist and extract the omega rate for each branch.
for (p in 1:length(datalist)){
omega.GAGA0200[p]<-datalist[[p]]$`branch attributes`$`0`[[9]]$`Baseline MG94xREV omega ratio`
names(omega.GAGA0200)[p]<-datalist[[p]]$`branch attributes`$`0`[[9]]$`original name`
}
for (p in 1:length(datalist)){
omega.B_chro[p]<-datalist[[p]]$`branch attributes`$`0`[[2]]$`Baseline MG94xREV omega ratio`
names(omega.B_chro)[p]<-datalist[[p]]$`branch attributes`$`0`[[2]]$`original name`
}
datalist[[3]]$`branch attributes`$`0`[[9]]omega.GAGA0200
omega.GAGA0200
load("/Users/lukas/Downloads/dataframeDNDS.Robj")
View(dnds_df)
library(reshape2)
melt(dnds_df, id.vars = c("
Code", "Country"))
head(dnds_df)
melt(dnds_df)
head(dnds_df)
dnds_df$gene<-rownames(dnds_df)
dnds2<-
melt(dnds_df, id.vars = "gene")
dnds_df2<-melt(dnds_df, id.vars = "gene")
dnds_df
dnds_df2
ggplot(dndf_df2)+geom_box
library(ggplot2)
ggplot(dndf_df2,aes(x=gene,y=var))+geom_boxplot()
head(dnds_df2)
ggplot(dndf_df2,aes(x=gene,y=value))+geom_boxplot()
ggplot(dnds_df2,aes(x=gene,y=value))+geom_boxplot()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot()
ggplot(dnds_df2,aes(x=gene,y=value))+geom_boxplot()+ylim(0,10)
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot()+ylim(0,10)
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot()+ylim(0,2.5)
install.packages("robustbase")
library(robustbase)
colMedians(dnds_df)
colMedians(as.matrix(dnds_df))
head(dnds_df)
load("/Users/lukas/Downloads/dataframeDNDS.Robj")
colMedians(as.matrix(dnds_df))
plot(dnds_df$omega.B_nipp,dnds_df$omega.GAGA0200)
plot(dnds_df$omega.B_nipp,dnds_df$omega.GAGA0200,log="xy")
lm(dnds_df$omega.B_nipp~~dnds_df$omega.GAGA0200)
lm(dnds_df$omega.B_nipp~dnds_df$omega.GAGA0200)
summary(lm(dnds_df$omega.B_nipp~dnds_df$omega.GAGA0200))
summary(lm(dnds_df$omega.B_nipp~dnds_df$omega.B_chro))
plot(dnds_df$omega.B_nipp,dnds_df$omega.B_chro,log="xy")
summary(lm(dnds_df$omega.B_nipp~dnds_df$omega.GAGA0200))
library(ggbeeswarm)
ggplot(dnds_df2,aes(x=variable,y=value))+geom_violin()+geom_quasirandom()
load("/Users/lukas/Downloads/dataframeDNDS.Robj")ggplot(dnds_df2,aes(x=variable,y=value))+geom_violin()+geom_quasirandom()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_violin()+geom_quasirandom()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_violin()+geom_quasirandom(width = 1)
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot()+ylim(0,2.5)
ggplot(dnds_df2,aes(x=variable,y=value))+geom_violin()+geom_boxplot(width=.2)+ylim(0,2.5)+geom_quasirandom()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2)+ylim(0,2.5)+geom_quasirandom(alpha=.2)
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2)+ylim(0,2.5)+geom_quasirandom(alpha=.1,size=.1)
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2)+ylim(0,2.5)+geom_quasirandom(alpha=.1,size=.4)
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2)+ylim(0,2.5)+geom_quasirandom(alpha=.1,size=.4)+theme_classic()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2,outlier.colour = NA)+ylim(0,2.5)+geom_quasirandom(alpha=.1,size=.4)+theme_classic()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2,outlier.colour = NA)+ylim(0,5)+geom_quasirandom(alpha=.1,size=.4)+theme_classic()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2,outlier.colour = NA)+ylim(0,5)+geom_quasirandom(alpha=.1,size=.4col="red")+theme_classic()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2,outlier.colour = NA)+ylim(0,5)+geom_quasirandom(alpha=.1,size=.4,col="red")+theme_classic()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=0.2)+geom_quasirandom(alpha=.1,size=.4,col="red")+theme_classic()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.1,size=.4,col="red")+theme_classic()
ggplot(dnds_df2,aes(x=variable,y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.3,size=.4,col="red")+theme_classic()
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.3,size=.4,col="red")+theme_classic()
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.3,size=.4,col="red")+theme_classic()+xlab("species")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.3,size=.4,col="red")+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.3,size=.4,col="red",width = 0.5)+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.3,size=.4,col="red",width = 0.2)+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.3,size=.4,col="red",width = 0.4)+theme_classic()+xlab("species")+ylab("omega")
dnds_median
load("/Users/lukas/Downloads/dataframeDNDS.Robj")
dnds_median<-colMedians(as.matrix(dnds_df))
dnds_median
max(dnds_df)
1e+10
(dnds_df$omega.B_C_nipp>1)
(dnds_df$omega.B_C_nipp[dnds_df$omega.B_C_nipp>1])
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.3,size=.4,col="red")+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+geom_quasirandom(alpha=.3,size=.4,col="red")+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.3,size=.4,col="red")+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom(alpha=.3)+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_quasirandom()+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+coord_cartesian(ylim=c(0,2))+geom_violin()+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+ylim(0,2)+geom_quasirandom(alpha=.3)+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df2,aes(x=gsub("omega.","",variable),y=value))+geom_boxplot(width=.2,outlier.colour = NA)+ylim(0,2)+geom_quasirandom(alpha=.3,size=.2,color="red")+theme_classic()+xlab("species")+ylab("omega")
ggplot(dnds_df,aes(x=omega.B_vafe,y=omega.GAGA0200))
ggplot(dnds_df,aes(x=omega.B_vafe,y=omega.GAGA0200))+geom_point()
ggplot(dnds_df,aes(x=omega.B_vafe,y=omega.GAGA0200))+geom_point()+xlim(0,2)+ylim(0,2)
ggplot(dnds_df,aes(x=omega.B_vafe,y=omega.GAGA0200))+geom_point(alpha=.2)+xlim(0,2)+ylim(0,2)
View(dnds_df)
ggplot(dnds_df)+geom_point(aes(x=omega.B_vafe,y=omega.GAGA0200),col="red",alpha=.2)+xlim(0,2)+ylim(0,2)+geom_point(aes(x=omega.B_vafe,y=omega.B_flor),col="green",alpha=.2)+
ggplot(dnds_df)+geom_point(aes(x=omega.B_vafe,y=omega.GAGA0200),col="red",alpha=.2)+xlim(0,2)+ylim(0,2)+geom_point(aes(x=omega.B_vafe,y=omega.B_flor),col="green",alpha=.2)
ggplot(dnds_df)+geom_point(aes(x=omega.B_vafe,y=omega.GAGA0200),col="red",alpha=.2)+xlim(0,1)+ylim(0,1)+geom_point(aes(x=omega.B_vafe,y=omega.B_flor),col="green",alpha=.2)
ggplot(dnds_df)+geom_point(aes(x=omega.B_vafe,y=omega.GAGA0200),col="red",alpha=.2)+xlim(0,1)+ylim(0,1)+geom_point(aes(x=omega.B_vafe,y=omega.B_flor),col="green",alpha=.2)+geom_point(aes(x=omega.B_vafe,y=omega.B_obli),col="blue",alpha=.2)
ggplot(dnds_df)geom_boxplot()
